<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Test Page - Dynamic Bar Chart</title>
        <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
        <style type="text/css">
            circle {
                fill : #fff;
                stroke: steelblue;
                stroke-width: 2;
            }
            circle:hover {
                stroke: brown;
            }
        </style>
    </head>
    <body>
        <script type="text/javascript">
            var dataset = [];
            for(var i = 0; i < 25; i++) {
                var val = Math.round(Math.random() * 28 + 2);
                dataset.push(val);
            }

            var width = 600,
                height = 300,
                separation = 1;

            var svg = d3.select("body").append("svg")
                          .attr("width", width)
                          .attr("height", height);

            /* below we use multivalue maps for d3.attr() and pass it a object */
            svg.selectAll("rect").data(dataset)
                .enter()
              .append("rect")
                .attr({
                    "x" : function(d, i) {
                            return width/dataset.length * i;},
                    "y" : function(d){
                            return height - (d * 10);},
                "width" : width/dataset.length - separation,
               "height" : function(d){
                            return d * 10;},
                 "fill" : function(d) {
                            return "rgb(0,0," + (d * 10) + ")"}
                });

            svg.selectAll("text").data(dataset)
                .enter()
              .append("text")
                .text(function(d){ return d; })
                .attr({
                    "text-anchor" : "middle",
                    "x" : function(d, i){ return (width / dataset.length) * i + (width / dataset.length - separation) / 2; },
                    "y" : function(d){ return height - (d * 10) + 15; },
                    "font-size" : "10px",
                    "font-family" : "sans-serif",
                    "fill" : "white"
                });

            console.log(dataset);
            console.log(d3.selectAll("rect"));
            console.log(d3.selectAll("text"));

        </script>
    </body>
</html>
